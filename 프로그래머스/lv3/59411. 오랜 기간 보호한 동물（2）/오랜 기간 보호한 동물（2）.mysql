# -- 코드를 입력하세요
# SELECT ANIMAL_INS.ANIMAL_ID, ANIMAL_INS.NAME
# FROM ANIMAL_INS
# INNER JOIN ANIMAL_OUTS
# ON ANIMAL_INS.ANIMAL_ID = ANIMAL_OUTS.ANIMAL_ID
# ORDER BY ANIMAL_OUTS.DATETIME - ANIMAL_INS.DATETIME DESC
# LIMIT 2









SELECT A.ANIMAL_ID, A.NAME
FROM ANIMAL_INS AS A
LEFT JOIN (
    SELECT *
    FROM ANIMAL_OUTS
) AS B
ON A.ANIMAL_ID = B.ANIMAL_ID
ORDER BY B.DATETIME - A.DATETIME DESC
LIMIT 2